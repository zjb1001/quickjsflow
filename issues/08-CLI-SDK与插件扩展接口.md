# CLI/SDK ä¸æ’ä»¶æ‰©å±•æ¥å£

## éœ€æ±‚
ä¸ºäº†è®©å¼€å‘è€…èƒ½å¤Ÿæ–¹ä¾¿åœ°ä½¿ç”¨ QuickJSFlowï¼Œéœ€è¦æä¾›ä¸¤å±‚æ¥å£ï¼š
1.  **CLI å·¥å…·**ï¼šç”¨äºå¿«é€ŸéªŒè¯ã€è°ƒè¯•å’Œæ‰§è¡Œç®€å•çš„è½¬æ¢ä»»åŠ¡ã€‚
2.  **Node.js SDK**ï¼šæä¾›å®Œæ•´çš„ç¼–ç¨‹æ¥å£ï¼Œä¾›å…¶ä»–å·¥å…·é›†æˆã€‚
æ­¤å¤–ï¼Œéœ€è¦è®¾è®¡ä¸€ä¸ªåŸºç¡€çš„**æ’ä»¶ç³»ç»Ÿ**ï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰ AST è½¬æ¢é€»è¾‘ã€‚

## Issue å…ƒæ•°æ®
- ç±»å‹ï¼šFeatureï¼ˆåº”ç”¨å±‚ï¼‰
- æ ‡ç­¾ï¼šcli, sdk, plugin, mvp
- è´Ÿè´£äººï¼š@page
- ä¾èµ–ï¼šIssue 06ï¼ˆCodegenï¼‰ã€Issue 05ï¼ˆEdit APIï¼‰
- ç›®æ ‡ç‰ˆæœ¬ï¼šv0.1.0ï¼ˆMVPï¼‰

## ğŸ“ é¡¹ç›®ç»“æ„ä¸å¼€å‘ç¯å¢ƒ

å‚è€ƒæ ¹ç›®å½• [issues/00-å®Œæ•´Issueæ¸…å•ä¸æ‰§è¡Œè®¡åˆ’.md](00-å®Œæ•´Issueæ¸…å•ä¸æ‰§è¡Œè®¡åˆ’.md) çš„**é¡¹ç›®ç»“æ„**ä¸**æ„å»ºä¸æµ‹è¯•å‘½ä»¤**ç« èŠ‚ã€‚å…³é”®è·¯å¾„ï¼š
- æºç ï¼š`src/main.c`ï¼ˆCLI å…¥å£ï¼Œå·²æœ‰ `lex`, `parse` å‘½ä»¤ï¼‰
- API å¤´æ–‡ä»¶ï¼š`include/quickjsflow/` å„æ¨¡å—çš„ .h æ–‡ä»¶
- æµ‹è¯•ï¼š`test/` æ¡†æ¶å·²å°±ä½
- å½“å‰å‘½ä»¤ï¼š`./build/quickjsflow lex|parse <file>`
- æ„å»ºï¼š`make`ï¼Œ`make test`
- æ‰©å±•å‡†å¤‡ï¼šç­‰å¾…åç»­æ¨¡å—ï¼ˆScope, Edit, Codegenï¼‰å®Œæˆ


## æŠ€æœ¯è¦ç‚¹

### 1. CLI è®¾è®¡
åŸºäº `commander` æˆ– `yargs` æ„å»ºã€‚
- `qjs parse <file> [options]`: è§£ææ–‡ä»¶å¹¶è¾“å‡º AST (JSON)ã€‚
- `qjs generate <ast-file> [options]`: å°† AST JSON è½¬å›ä»£ç ã€‚
- `qjs check <file>`: æ‰§è¡Œè¯­æ³•å’Œä½œç”¨åŸŸæ£€æŸ¥ï¼ŒæŠ¥å‘Šé”™è¯¯ã€‚
- `qjs run <file> --plugin <path>`: è§£ææ–‡ä»¶ï¼Œåº”ç”¨æ’ä»¶è½¬æ¢ï¼Œç„¶åè¾“å‡ºä»£ç ã€‚

### 2. SDK API è®¾è®¡
æä¾› TypeScript ç±»å‹å®šä¹‰çš„æ¨¡å—å¯¼å‡ºã€‚
```typescript
import { parse, generate, analyze, traverse } from 'quickjsflow';

// 1. Parse
const ast = parse("const a = 1;");

// 2. Analyze Scope
const scopeManager = analyze(ast);

// 3. Transform (Plugin)
traverse(ast, {
  Identifier(node) {
    // ...
  }
});

// 4. Generate
const { code, map } = generate(ast);
```

### 3. æ’ä»¶ç³»ç»Ÿï¼ˆPlugin Systemï¼‰
æ’ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ Visitor å¯¹è±¡æˆ–å‡½æ•°ã€‚
```javascript
// my-plugin.js
module.exports = function(babel) {
  return {
    visitor: {
      Identifier(path) {
        if (path.node.name === 'foo') {
          path.node.name = 'bar';
        }
      }
    }
  };
};
```
*æ³¨ï¼šMVP é˜¶æ®µæ’ä»¶ç³»ç»Ÿå¯ç®€åŒ–ï¼Œä»…æ”¯æŒåŸºç¡€ Visitorã€‚*

## äº¤ä»˜ç‰©
- ğŸ“¦ npm åŒ…ç»“æ„ï¼ˆ`bin`, `lib`, `types`ï¼‰
- ğŸ’» CLI å¯æ‰§è¡Œæ–‡ä»¶
- ğŸ“š API æ–‡æ¡£ï¼ˆTypeDocï¼‰
- ğŸ”Œ ç¤ºä¾‹æ’ä»¶ï¼ˆå¦‚ï¼šç§»é™¤ console.logï¼‰

## ä»»åŠ¡æ¸…å•
- [ ] æ­å»º CLI æ¡†æ¶ï¼ˆå‚æ•°è§£æã€å¸®åŠ©ä¿¡æ¯ï¼‰ã€‚
- [ ] å®ç° `parse`, `generate`, `check` å‘½ä»¤ã€‚
- [ ] å°è£… SDK ç»Ÿä¸€å…¥å£ï¼ˆindex.tsï¼‰ã€‚
- [ ] è®¾è®¡å¹¶å®ç°åŸºç¡€æ’ä»¶åŠ è½½å™¨ï¼ˆåŠ¨æ€ requireï¼‰ã€‚
- [ ] ç¼–å†™ CLI é›†æˆæµ‹è¯•ï¼ˆè°ƒç”¨å­è¿›ç¨‹ï¼‰ã€‚

## éªŒæ”¶æ ‡å‡†
- âœ… CLI å‘½ä»¤èƒ½æ­£ç¡®å¤„ç†è¾“å…¥è¾“å‡ºæ–‡ä»¶å’Œæ ‡å‡†æµï¼ˆstdin/stdoutï¼‰ã€‚
- âœ… SDK å¯¼å‡ºæ¸…æ™°ï¼Œç±»å‹å®šä¹‰å®Œæ•´ã€‚
- âœ… èƒ½å¤ŸåŠ è½½å¤–éƒ¨æ’ä»¶å¹¶å¯¹ä»£ç äº§ç”Ÿä¿®æ”¹ã€‚
- âœ… é”™è¯¯å¤„ç†å‹å¥½ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨ã€è¯­æ³•é”™è¯¯ç­‰ï¼‰ã€‚

## ä¼˜å…ˆçº§
ğŸŸ¡ **MVP åæœŸ**ï¼ˆä¾èµ–æ ¸å¿ƒæ¨¡å—ç¨³å®šï¼‰

## ç›¸å…³ Issue
- Issue 05: Edit APIï¼ˆæ’ä»¶ç³»ç»Ÿçš„åŸºç¡€ï¼‰
- Issue 06: Codegenï¼ˆCLI è¾“å‡ºçš„åŸºç¡€ï¼‰

